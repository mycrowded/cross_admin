(this.webpackJsonpcross_admin=this.webpackJsonpcross_admin||[]).push([[0],{404:function(e,t,a){},537:function(e,t,a){"use strict";a.r(t);var n=a(6),c=a(0),r=a(14),s=a.n(r),o=(a(404),a(628)),i=a(627),l=a(348),j=a(23),b=a(109),u=a(600),d=a(354),O=a(601),h=a(635),x=a(632),m=a(356),p=a(321),f=a(633),g=a(629),v=a(630),k=a(640),y=a(614),w=a(94),C=a.n(w),S=a(159),P=a(160),I=a(190),T=a(188),N=a(8),D=a(304),F=a.n(D),A=a(5),B=a(15),E=a(67),L=a.n(E),M=a(7),R=a.n(M),_=a(591),z=a(51),J=a(599),U=a(309),H=a.n(U),W=a(595),q=a(596),G=a(597),Y=a(598),K=a(28),Q=function(e){Object(I.a)(a,e);var t=Object(T.a)(a);function a(){var e;Object(S.a)(this,a);for(var n=arguments.length,c=new Array(n),r=0;r<n;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).state={showDialog:!1},e.handleClick=function(){e.setState({showDialog:!0})},e.handleCloseClick=function(){e.setState({showDialog:!1})},e.handleDelete=function(t){t.preventDefault(),e.setState({showDialog:!1});var a=e.props,n=a.dispatchCrudDelete,c=a.startUndoable,r=a.resource,s=a.record,o=a.basePath,i=a.redirect;a.undoable?c(Object(_.c)(r,s.id,s,o,i)):n(r,s.id,s,o,i)},e}return Object(P.a)(a,[{key:"render",value:function(){var e=this.state.showDialog,t=this.props,a=t.label,r=void 0===a?"ra.action.delete":a,s=t.classes,o=void 0===s?{}:s,i=t.className;return Object(n.jsxs)(c.Fragment,{children:[Object(n.jsx)(K.a,{onClick:this.handleClick,label:r,className:R()("ra-delete-button",o.deleteButton,i),children:Object(n.jsx)(L.a,{})},"button"),Object(n.jsxs)(W.a,{fullWidth:!0,open:e,onClose:this.handleCloseClick,"aria-label":"Are you sure?",children:[Object(n.jsx)(q.a,{children:"Are you sure you want to delete this entity?"}),Object(n.jsx)(G.a,{children:Object(n.jsx)("div",{children:"Your actions will be logged."})}),Object(n.jsxs)(Y.a,{children:[Object(n.jsx)(K.a,{onClick:this.handleDelete,label:r,className:R()("ra-delete-button",o.deleteButton,i),children:Object(n.jsx)(L.a,{})},"button"),Object(n.jsx)(K.a,{label:"ra.action.cancel",onClick:this.handleCloseClick,children:Object(n.jsx)(H.a,{})})]})]})]})}}]),a}(c.Component);Q.defaultProps={redirect:"list",undoable:!0};var V=F()(Object(N.c)(null,{startUndoable:z.h,dispatchCrudDelete:_.c}),J.a,Object(A.a)((function(e){return{deleteButton:{color:e.palette.error.main,"&:hover":{backgroundColor:Object(B.c)(e.palette.error.main,.12),"@media (hover: none)":{backgroundColor:"transparent"}}}}})))(Q),X=function(e){var t=e.basePath;e.data;return Object(n.jsx)(b.a,{children:Object(n.jsx)(u.a,{basePath:t,label:"Back",icon:Object(n.jsx)(C.a,{})})})},Z=function(e){return Object(n.jsx)(d.a,Object(j.a)(Object(j.a)({},e),{},{children:Object(n.jsx)(O.a,{label:"crossings.action.save_and_add",redirect:!1,submitOnEnter:!1,variant:"flat"})}))},$=function(e){return Object(n.jsx)(h.a,Object(j.a)(Object(j.a)({toolbar:Object(n.jsx)(Z,{}),actions:Object(n.jsx)(X,{})},e),{},{children:Object(n.jsxs)(x.a,{children:[Object(n.jsx)(m.a,{source:"id",label:"Switch ID",validate:Object(p.b)()}),Object(n.jsx)(m.a,{source:"crossingFrom",label:"crossingFrom",validate:Object(p.b)()}),Object(n.jsx)(m.a,{source:"crossingTo",label:"crossingTo",validate:Object(p.b)()}),Object(n.jsx)(m.a,{source:"locationName",label:"locationName",validate:Object(p.b)()}),Object(n.jsx)(m.a,{source:"latitude",label:"latitude",validate:Object(p.b)()}),Object(n.jsx)(m.a,{source:"longitude",label:"longitude",validate:Object(p.b)()}),Object(n.jsx)(m.a,{multiline:!0,source:"notes",label:"notes"})]})}))},ee=function(e){return Object(n.jsx)(f.a,Object(j.a)(Object(j.a)({actions:Object(n.jsx)(X,{}),title:"Post Edit"},e),{},{children:Object(n.jsxs)(x.a,{children:[Object(n.jsx)(m.a,{disabled:!0,label:"switchID",source:"id"}),Object(n.jsx)(m.a,{source:"crossingFrom",label:"crossingFrom",validate:Object(p.b)()}),Object(n.jsx)(m.a,{source:"crossingTo",label:"crossingTo",validate:Object(p.b)()}),Object(n.jsx)(m.a,{source:"locationName",label:"locationName",validate:Object(p.b)()}),Object(n.jsx)(m.a,{source:"latitude",label:"latitude",validate:Object(p.b)()}),Object(n.jsx)(m.a,{source:"longitude",label:"longitude",validate:Object(p.b)()}),Object(n.jsx)(m.a,{multiline:!0,source:"notes",label:"notes"})]})}))},te=function(e){return Object(n.jsx)(g.a,Object(j.a)(Object(j.a)({},e),{},{children:Object(n.jsxs)(v.a,{children:[Object(n.jsx)(k.a,{source:"id",label:"Id"}),Object(n.jsx)(k.a,{source:"crossingFrom",label:"CrossingFrom"}),Object(n.jsx)(k.a,{source:"crossingTo",label:"CrossingTo"}),Object(n.jsx)(k.a,{source:"locationName",label:"LocationName"}),Object(n.jsx)(k.a,{source:"latitude",label:"Latitude"}),Object(n.jsx)(k.a,{source:"longitude",label:"Longitude"}),Object(n.jsx)(k.a,{source:"notes",label:"Notes"}),Object(n.jsx)(y.a,{}),Object(n.jsx)(V,{})]})}))},ae=a(615),ne=a(634),ce=(a(642),function(e){var t=e.basePath;e.data;return Object(n.jsx)(b.a,{children:Object(n.jsx)(u.a,{basePath:t,label:"Back",icon:Object(n.jsx)(C.a,{})})})}),re=function(e){return Object(n.jsx)(d.a,Object(j.a)(Object(j.a)({},e),{},{children:Object(n.jsx)(O.a,{label:"crossings.action.save_and_add",redirect:!1,submitOnEnter:!1,variant:"flat"})}))},se=function(e){return Object(n.jsx)(h.a,Object(j.a)(Object(j.a)({toolbar:Object(n.jsx)(re,{}),actions:Object(n.jsx)(ce,{})},e),{},{children:Object(n.jsxs)(x.a,{children:[Object(n.jsx)(m.a,{source:"username",label:"Email",validate:Object(p.b)()}),Object(n.jsx)(ae.a,{source:"password",label:"Password",validate:Object(p.b)()}),Object(n.jsx)(ne.a,{source:"role",choices:[{id:"Admin",name:"Admin"},{id:"Switch Installer",name:"Switch Installer"}]})]})}))},oe=function(e){return Object(n.jsx)(g.a,Object(j.a)(Object(j.a)({},e),{},{children:Object(n.jsxs)(v.a,{children:[Object(n.jsx)(k.a,{label:"Email",source:"id"}),Object(n.jsx)(k.a,{label:"Role",source:"role"}),Object(n.jsx)(V,{})]})}))},ie=a(607),le=a(620),je=a(621),be=a(608),ue=a.p+"static/media/logoRed.dacd7a0c.png",de=a(136),Oe=a(619),he=Object(de.a)((function(e){return{root:{flexGrow:1},paper:{padding:e.spacing(2),textAlign:"center",color:e.palette.text.secondary}}})),xe=function(){var e=he();return Object(n.jsx)("div",{className:e.root,children:Object(n.jsx)(Oe.a,{container:!0,spacing:3,children:Object(n.jsx)(Oe.a,{item:!0,xs:12,children:Object(n.jsx)(ie.a,{className:e.paper,children:Object(n.jsxs)(le.a,{children:[Object(n.jsx)(je.a,{style:{justifyContent:"center",display:"flex"},children:Object(n.jsx)("img",{src:ue})}),Object(n.jsx)(be.a,{children:"Welcome to the CROSS administration"})]})})})})})},me=a(120),pe=a.n(me),fe=a(181),ge=a(336),ve={login:function(){var e=Object(fe.a)(pe.a.mark((function e(t){var a,n,c;return pe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.username,n=t.password,c=new Request("https://crowdedcross.com/authenticate",{method:"POST",body:JSON.stringify({username:a,password:n}),headers:new Headers({"Content-Type":"application/json"})}),e.abrupt("return",fetch(c).then((function(e){if(e.status<200||e.status>=300)throw new Error(e.statusText);return e.json()})).then((function(e){var t=e.token,a=Object(ge.a)(t);localStorage.setItem("token",t),localStorage.setItem("permissions",a.permissions)})));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),logout:function(){return localStorage.removeItem("token"),localStorage.removeItem("permissions"),Promise.resolve()},checkError:function(e){},checkAuth:function(){return localStorage.getItem("token")?Promise.resolve():Promise.reject()},getPermissions:function(){var e=localStorage.getItem("permissions");return e?Promise.resolve(e):Promise.reject()}},ke=a(236),ye=a(337),we=a.n(ye),Ce=Object(ke.a)({palette:{primary:{main:"#b43f3f"},secondary:{main:"#b43f3f"},error:we.a,contrastThreshold:3,tonalOffset:.2},typography:{fontFamily:["-apple-system","BlinkMacSystemFont",'"Segoe UI"',"Arial","sans-serif"].join(",")},overrides:{MuiButton:{root:{color:"white"}}}}),Se=a(631),Pe=a(358),Ie=a(115),Te=a(183),Ne=a(184),De=a.n(Ne),Fe=a(338),Ae=a.n(Fe),Be=a(339),Ee=a.n(Be),Le=a(622),Me=function(e){var t=e.onMenuClick,a=e.logout,c=Object(Le.a)(),r=c.loaded,s=c.permissions;console.log("perm",s);var o=Object(Pe.a)((function(e){return e.breakpoints.down("xs")})),i=Object(N.f)((function(e){return e.admin.ui.sidebarOpen})),l=Object(N.f)(Ie.b);return r?Object(n.jsxs)("div",{children:[Object(n.jsx)(Te.a,{to:"/",primaryText:"Home",leftIcon:Object(n.jsx)(Ae.a,{}),onClick:t,sidebarIsOpen:i}),l.map((function(e){return Object(n.jsx)(Te.a,{to:"/".concat(e.name),primaryText:e.options&&e.options.label||e.name,leftIcon:e.icon?Object(n.jsx)(e.icon,{}):Object(n.jsx)(De.a,{}),onClick:t,sidebarIsOpen:i},e.name)})),Object(n.jsx)(Te.a,{to:"map",primaryText:"CROSS Locations Map",leftIcon:Object(n.jsx)(Ee.a,{}),onClick:t}),o&&a]}):null},Re=function(e){return Object(n.jsx)(Se.a,Object(j.a)(Object(j.a)({},e),{},{menu:Me}))},_e=a(639),ze=a.p+"static/media/background.af3a3cc5.jpg",Je=Object(A.a)({card:{padding:"15px 0 15px 0"},icon:{background:"#b43f3f"}})((function(e){return Object(n.jsx)(_e.a,Object(j.a)({backgroundImage:ze},e))})),Ue=a(157),He=function(){var e=Object(fe.a)(pe.a.mark((function e(t){var a,n,c,r,s,o,i,l,b,u,d=arguments;return pe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=d.length>1&&void 0!==d[1]?d[1]:{},(n=a.headers||new Headers({Accept:"application/json"})).has("Content-Type")||a&&a.body&&a.body instanceof FormData||n.set("Content-Type","application/json"),a.user&&a.user.authenticated&&a.user.token&&n.set("Authorization",a.user.token),e.next=6,fetch(t,Object(j.a)(Object(j.a)({},a),{},{headers:n}));case 6:return c=e.sent,e.next=9,c.text();case 9:r=e.sent,s={status:c.status,statusText:c.statusText,headers:c.headers,body:r},o=s.status,i=s.statusText,l=s.headers,b=s.body;try{u=JSON.parse(b)}catch(O){}if(!(o<200||o>=300)){e.next=15;break}return e.abrupt("return",Promise.reject(new Ue.a(u&&u.error&&u.error.message||i,o,u)));case 15:return e.abrupt("return",Promise.resolve({status:o,headers:l,body:b,json:u}));case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),We=(a(514),a(234)),qe=a(21),Ge=a(624),Ye=a(644),Ke=a(625),Qe=a(626),Ve=(a(518),a(347)),Xe=a(72),Ze=function(e){Object(I.a)(a,e);var t=Object(T.a)(a);function a(e){var n;return Object(S.a)(this,a),(n=t.call(this,e)).getData=function(){return fetch("https://crowdedcross.com/crossings/crossingList").then((function(e){if(e.ok)return e.json();throw new Error(e.status)})).then((function(e){n.setState({marker:e},(function(){}))})).catch((function(e){e&&console.log(e)}))},n.state={defaultPosition:[53.80127,-1.548567],crossLocations:[{title:"leeds",position:[53.80127,-1.548567]},{title:"kirkstall",position:[53.84127,-1.528567]}],marker:null},n}return Object(P.a)(a,[{key:"componentWillMount",value:function(){this.getData()}},{key:"render",value:function(){if(null==this.state.marker)return Object(n.jsx)("h1",{children:" Loading "});var e=this.state.marker;return Object(n.jsxs)(Ge.a,{center:this.state.defaultPosition,zoom:13,style:{height:"100%",width:"100%"},children:[Object(n.jsx)(Ye.a,{attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),e.map((function(e){return Object(n.jsx)(Ke.a,{position:[e.latitude,e.longitude],icon:new Xe.Icon({iconUrl:Ve.a,iconSize:[25,41],iconAnchor:[12,41]}),children:Object(n.jsx)(Qe.a,{children:e.locationName})},e.locationName)}))]})}}]),a}(c.Component),$e=[Object(n.jsx)(qe.b,{exact:!0,path:"/map",component:Ze})],et=a(353),tt=a.n(et),at=a(352),nt=a.n(at),ct=function(e){We.NotificationManager.error(e.message,e.name,3e3)},rt=Object(l.a)("https://crowdedcross.com",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=localStorage.getItem("token");return t.user={authenticated:!0,token:a},He(e,t).catch((function(e){ct(e)}))})),st=function(){return Object(n.jsx)(o.a,{loginPage:Je,dashboard:xe,dataProvider:rt,authProvider:ve,theme:Ce,customRoutes:$e,layout:Re,children:function(e){return[Object(n.jsx)(i.a,{name:"crossings",list:te,edit:ee,create:$,icon:nt.a}),"Admin"===e?Object(n.jsx)(i.a,{name:"administrator",list:oe,create:se,icon:tt.a}):null,Object(n.jsx)("div",{children:Object(n.jsx)(We.NotificationContainer,{})})]}})},ot=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,645)).then((function(t){var a=t.getCLS,n=t.getFID,c=t.getFCP,r=t.getLCP,s=t.getTTFB;a(e),n(e),c(e),r(e),s(e)}))};s.a.render(Object(n.jsx)(st,{}),document.getElementById("root")),ot()}},[[537,1,2]]]);
//# sourceMappingURL=main.4af125fe.chunk.js.map